<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <button id="myget">get</button>
    <button id="mypost">post1</button>
    <button id="myput">put</button>
    <button id="mypatch">patch</button>
    <button id="mydelete">delete</button>
    <script>
        myget.onclick = function () {
            /* ajax({
                url: "http://localhost:3000/users",
                data: {
                    username: "kerwin",
                    password: "789"
                },
                success: function (res) {
                    console.log("sucess", res)
                },
                error: function (err) {
                    console.log("error", err)
                }
            }) */
            //get请求
            var username = "xiaoming"
            fetch(`http://localhost:3000/users?username=${username}`)
                //拿到一个json格式的promise对象 
                .then(res => {
                    console.log(res)
                    if (res.ok) {
                        return res.json()
                    } else {
                        //拒绝承诺,防止直接走下一个.then
                        //告诉你哪里错了
                        return Promise.reject({
                            status:res.status,
                            statusText:res.statusText
                        })
                    }
                })//res.json() res.text() 
                .then(res => {
                    console.log(res)//拿到结果
                }).catch(err => {
                    console.log(err)
                })
        }

        mypost.onclick = function () {
            /*  ajax({
                 url: "http://localhost:3000/users",
                 data: {
                     username: "xiaoming",
                     password: "123456"
                 },
                 method: "POST",
                 headers: {
                     "content-type": "application/x-www-form-urlencoded"
                 },
                 success: function (res) {
                     console.log("sucess", res)
                 },
                 error: function (err) {
                     console.log("error", err)
                 }
             }) */

             /* fetch("http://localhost:3000/users",{
                method: "POST",//fetch默认请求是get,这里是post请求直接改
                headers: {
                     "content-type": "application/x-www-form-urlencoded"
                 },
                 //post参数是放在请求体中的,所以是body
                 body:"username=tiechui&password=123"
             })
             .then(res=>res.json())
             .then(res=>{
                console.log(res)
             }) */
             //json格式
             fetch("http://localhost:3000/users",{
                method: "POST",//fetch默认请求是get,这里是post请求直接改
                headers: {
                     "content-type": "application/json"
                 },
                 //post参数是放在请求体中的,所以是body
                 body:JSON.stringify({
                    username:"shanzhen",
                    password:"1234"
                 })
             })
             .then(res=>res.json())
             .then(res=>{
                console.log(res)
             })
        }

        myput.onclick = function () {
            /*  ajax({
                 url: "http://localhost:3000/users/1",
                 data: {
                     username: "ximenlaoshi",
                     password: "456"
                 },
                 method: "PUT",
                 headers: {
                     "content-type": "application/json"
                 },
                 success: function (res) {
                     console.log("sucess", res)
                 },
                 error: function (err) {
                     console.log("error", err)
                 }
             }) */
             fetch("http://localhost:3000/users/2",{
                method: "PUT",
                headers: {
                     "content-type": "application/json"
                 },
                 //post参数是放在请求体中的,所以是body
                 body:JSON.stringify({
                    username:"shanzhen"
                    //password:"1234"
                 })
             })
             .then(res=>res.json())
             .then(res=>{
                console.log(res)
             })
        }

        mypatch.onclick = function () {
            /*  ajax({
                 url: "http://localhost:3000/users/1",
                 data: {
                     username: "ximenlaoshi11111",
 
                 },
                 method: "PATCH",
                 headers: {
                     "content-type": "application/json"
                 },
                 success: function (res) {
                     console.log("sucess", res)
                 },
                 error: function (err) {
                     console.log("error", err)
                 }
             }) */
             fetch("http://localhost:3000/users/3",{
                method: "PATCH",
                headers: {
                     "content-type": "application/json"
                 },
                 //post参数是放在请求体中的,所以是body
                 body:JSON.stringify({
                    username:"shanzhen"
                    //password:"1234"
                 })
             })
             .then(res=>res.json())
             .then(res=>{
                console.log(res)
             })
        }

        /* mydelete.onclick = function () {
            ajax({
                url: "http://localhost:3000/users/1",
                method: "DELETE",
                success: function (res) {
                    console.log("sucess", res)
                },
                error: function (err) {
                    console.log("error", err)
                }
            })
        } */
        fetch("http://localhost:3000/users/4",{
                method: "DELETE"
             })
             .then(res=>res.json())
             .then(res=>{
                console.log(res)
             })
    </script>
</body>

</html>